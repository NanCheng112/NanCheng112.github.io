---
title: 遥感图像处理-图像增强
date: 2025-8-26 09:21:00
updated: 2025-8-26 16:08:00
tags:
    - 遥感
    - 图像处理
categories:
    - 遥感概论
katex: true
---

# **图像增强**
图像去噪声的目的是改善图像的数据质量，而图像增强的目的主要是改善图像的视觉效果。通过一些手段对原图像进行变换或附加一些信息，有选择地突出图像中感兴趣的特征或者抑制图像中不需要的特征，从而加强对图像的目视判读和识别效果。   

从**处理过程**上而言，图像增强方法主要分为**空间域图像增强**和**变换域图像增强**，空间域图像增强直接对图线的灰度值做运算；变换域则是在图像的某个变换域内对图像的变换系数进行修改再反变换到空间域实现增强。    

同时，**伪彩色变换**也是一种空间域增强方式，但区别于通常的灰度值运算，其利用人眼对于彩色变化较灰度变化更加敏感这一特征增强图像对比度。     

此外，一些方法在空间域和变换域均可实现甚至是二者交叉应用，例如**图像融合方法**，主要通过多源信息进行复合增强图像视觉效果。    

## **空间域图像增强**
根据决定输出图像像元灰度值的方法不同可分为**点运算**、**邻域运算**和**灰度值梯度运算**。决定输出像元的因素分别是输入像元的灰度值、输入像元及其邻域像元的灰度值和输入像元及其结构元素。    

### **点运算**
* 灰度变换：通过变换函数对输入像元的灰度值进行处理，分为**线性变换**、**分段线性变换**、**反比运算**、**幂次变换**、**对数和反对数变换**。其中反比运算公式如下：   
$$y=x_{max}+x_{min}-x$$
* 直方图调整：通过修改图像的直方图进行处理，方法有**直方图匹配**和**直方图均衡化**等。  
直方图匹配将原图像的直方图以参考图像的直方图为标准做变换，使两幅图像的直方图近似，其原理是对原图像中任意一个灰度值$a_i$都可以在参考图像上找到一个对应的灰度值$b_j$从而使原图像灰度概率分布于参考图像相似。   
直方图均衡化将参考图像的直方图更换为均匀分布的直方图，设计原理是当直方图均匀分布时信息熵最大。        
![图片1](https://github.com/NanCheng112/NanCheng112.github.io/blob/hexo/source/_posts/remote_sensing/pic_pro-7.jpg?raw=true)           

> 直方图：横坐标为灰度值，纵坐标为各灰度值在图像中出现的像元数；   
累计直方图：横坐标为灰度值，纵坐标为图像中小于和等于该灰度值的像元数；   
灰度概率直方图：横坐标为灰度值，纵坐标为各灰度值出现的像元数除以总像元数；    
累计概率直方图：横坐标为灰度值，纵坐标为图像中小于和等于该灰度值的像元数除以总像元数。

### **邻域运算**
邻域运算一般采用卷积滤波来实现，卷积滤波有平滑与锐化两种处理方式，使用锐化来增强图像的边缘及纹理信息。
* **反锐化掩膜图像增强**：先对原图像做平滑滤波，然后将原图像减去平滑滤波结果得到图像的边缘信息，最后将加权的边缘信息与原图像相加。   

* **微分算子**：图像的细节信息在图像上表现为局部的灰度变化，可通过计算微分来提取这些细节信息，再叠加到原图像上实现锐化增强。   
常用一阶微分算子有：单方向微分算子、$Roberts$交叉微分算子、$Sobel$微分算子、$Prewitt$微分算子。   
常用二阶微分算子有：拉普拉斯微分算子、$Wallis$微分算子。


### **灰度形态学梯度计算**
经过膨胀处理的图像，地物边缘会向灰度低的区域扩散，而经过膨胀处理的图像，地物边缘会向灰度高的区域收缩。经过膨胀和腐蚀处理的图像，与原图像在地物边缘会存在灰度值梯度差异而地物内部同质区域内部灰度值不变可用来检测边缘。对于图像$A$与结构元素$B$常用形态学梯度有如下几种定义方法：   
* 膨胀腐蚀型梯度
$$Grad_1(A)=(A\oplus B)-(A\ominus B)$$
* 腐蚀型梯度
$$Grad_2(A)=A-(A\ominus B)$$
* 膨胀型梯度
$$Grad_3(A)=(A\oplus B)-A$$

采用灰度学梯度运算进行图像增强需要注意结构元素的尺寸和形状对图形处理结果的影响：识别特定形状的地物构建相应形态的结构元素；结构元素过大可较好检测边缘，但会丢失细节；结构元素过小会增强噪音信息。   

## **变换域图像增强**
### **傅里叶变换**
基本原理是图像的细节信息对应于频率域的高频部分，在频率域高频部分进行增强再反变换到空间域或仅提取高频信息叠加到原图像。基本操作与图像去噪相似。
* 高频增强  

* 高通滤波：理想高通滤波器、巴特沃斯高通滤波器、高斯高通滤波器

* 带通滤波器： 理想带通滤波器、巴特沃斯带通滤波器、高斯带通滤波器

* 同态滤波：在图像采集过程中当照度不均匀时图像上对应照度暗的地方纹理不清晰，可通过灰度范围压缩和对比度两种手段增强图像在照度暗区域的纹理，即通过**同态滤波**解决。    
从图像的形成和光照的特性上看，一幅图像可认为是光源的照度分量和目标场的反射分量乘积组成的，照度分量对应于空间域图像灰度变化缓慢的部分可看作是图像的低频分量，反射分量往往引起突变可看作是图像的高频分量。   
同态滤波以不同方式影响傅里叶变换的高低频分量，达到对低频分量压缩、对高频分量增强的效果。
> 照度-反射模型认为图像$f(x,y)$能被表达为照度与反射两部分的乘积，因为两个函数乘积在傅里叶变换中不可分,故先要对两边分别取对数改为加和形式。$$f(x,y)=i(x,y) \cdot l(x,y)$$

### **小波变换**
与图像去噪原理相同但增强高频部分以实现锐化。

### **颜色空间变换**
将图像从一个颜色空间变换到另一个颜色空间进行处理，再反变换到原来的颜色空间。如将原图像从$RGB$空间变换到$HSI$空间，分别对亮度和饱和度两个分量独立进行平方根变换，再转换回$RGB$空间。

### **其它变换**
与图像去噪相同。

## **伪彩色处理**
伪彩色处理方法不改变图像的像元灰度值，而是建立一个像元灰度值与颜色空间分量之间的对应关系，使灰度值映射到三维的色彩空间。    

如果对图像的每一个灰度值均赋予一个独立的色彩则图像被称为伪彩色图像；如果将图像的灰度值进行分层，对每个范围内的灰度值赋予不同的颜色称为进行密度分割。伪彩色图像是密度分割的一种特殊形式，其分层间隔为一个灰度级。   

密度分割优点在于当分层方案与地物光谱差异对应较好时能够直观地区分不同地物。

## **图像融合**
图像融合就是对多源信息进行取长补短，着重于把时间或空间中存在互补的多源数据按照一定法则进行运算，从而获得比任一单一数据更为精确、信息更丰富的图像。     

图像融合根据数据的抽象程度自下而上可在三个层级上进行，分别是数据级融合、特征级融合和决策级融合。数据级（像元级）在原始数据层上进行融合；特征级先提取各种数据源的特征信息再对这些特征进行综合分析和融合；决策级指在图像理解和图像识别的基础上进行的融合。    

图像增强用途上主要是在数据级上，常见应用有把高分辨率的全色灰度图像与低分辨率多光谱彩色图像进行融合得到一幅高空间分辨率的彩色合成图像等。在进行数据融合之前输入数据需要匹配：
* 空间信息匹配：高低分辨率图像均需通过坐标转换统一坐标，低分辨率图像需重采样使空间分辨率与高分辨率影像相同。

* 光谱信息匹配：保证输入影像的同名点像元的灰度值有较好的相关性，尽可能保持在同一季节且图像间不能有过大的地物变化；应将图像的直方图尽可能调整为一致使图像的亮度值趋于协调。

数据级融合既可以在空间域上进行也可在变换域中进行，空间域中常见方法有$Brovey$法、$PBIM$法和$SFIM$法，变换域中有主成分分析法、小波变换法和$HSI$变换法。